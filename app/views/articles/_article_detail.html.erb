<table class="table card-table" id='article-show'>
  <tbody>
    <tr>
      <td style="text-align:left;"><%= label :article, :slug , class: "form-label", style: 'color: #7795c1;'%></td>
      <td><%= link_to @article.slug, request.base_url+'/'+@article.slug %></td>
    </tr>
    <tr>
      <td style="text-align:left;width: 170px;"><%= label :article, :title , class: "form-label", style: 'color: #7795c1;'%></td>
      <td><%= @article.title %><br />
      <% @article.titlings.group_by(&:title_type_id).each do |k,v| %>
        <% for t in v%>
        | <%= t.content%>
        <%end%>

      <%end%>
      </td>
    </tr>
    <tr>
      <td style="text-align:left;"><%= label :article, :abstract , class: "form-label", style: 'color: #7795c1;'%></td>
      <td><%= @article.abstract %></td>
    </tr>
    <tr>
      <td style="text-align:left;">
        <%= label :article, :url , class: "form-label", style: 'color: #7795c1;'%></td>
        <td><%= link_to @article.url, @article.url %></td>
      </tr>

      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :keywords%></td>
        <td><% for tagging in Tagging.where(taggable_id: @article.id, taggable_type: 'Article', target_type: 'Keyword') %>
          <% @keyword = Keyword.find_by_id(tagging.target_id)%>
          <% if !@keyword.blank?%>
          <span class="tag"><%= @keyword.title%></span>
          <%end%>
          <%end%>
        </td>
      </tr>

      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :datings%></td>
        <td>
          <% for dating in @article.datings %>
          <%= dating.article_event.title%>:
          <span>
            <% @jalali = JalaliDate.to_jalali(dating.event_date)%>
            <%= @jalali.year%>/<%= @jalali.month%>/<%= @jalali.day%>
          </span> |
          <%end%>
        </td>
      </tr>

      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :article_type%></td>
        <td>
          <% for typing in @article.typings %>
          <%= typing.article_type.title%> |
          <%end%>
        </td>
      </tr>
      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :language%></td>
        <td>
          <% for speaking in @article.speakings %>
          <%= speaking.language.title%> |
          <%end%>
        </td>
      </tr>
      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :article_format%></td>
        <td>
          <% for formating in @article.formatings %>
          <%= formating.article_format.title%> |
          <%end%>
        </td>
      </tr>
      <tr>
        <td style='color: #7795c1;text-align:left;'><%=t :contributors%></td>
        <td>
          <ul>
            <% for contribution in @article.contributions %>
            <li>
              <% if  !contribution.profile.blank? %>
              <%=link_to contribution.profile.fullname, contribution.profile%>,
              <%end%>
              <% if  !contribution.duty.blank? %>
              <%= link_to contribution.duty.title, contribution.duty%>,
              <%end%>
              <% if  !contribution.role.blank? %>
              <%= link_to contribution.role.title, contribution.role%>
              <%end%>
            </li>
            <%end%>

          </td>
        </tr>
        <tr>
          <td style='color: #7795c1;text-align:left;'><%=t :relations%></td>
          <td>
            <% @article.kinships.group_by(&:article_relation_type_id).each do |k,v| %>
            <%= ArticleRelationType.find(k).title%>:
            <ul>
              <% for kinship in v.sort_by!(&:rank)%>
              <li><%= link_to kinship.kin.title, kinship.kin%></li>
              <% end %>
            </ul>
            <%end%>
          </td>
        </tr>
        <tr>
          <td style='color: #7795c1;text-align:left;'><%=t :article_source%></td>
          <td>
            <% for originating in @article.originatings %>
            <%= originating.article_source.title%> |
            <%end%>
          </td>
        </tr>
        <tr>
          <td style='color: #7795c1;text-align:left;'><%=t :article_area%></td>
          <td>
            <% for areaing in @article.areaings %>
            <%= areaing.article_area.title%> |
            <%end%>
          </td>
        </tr>

        <tr>
          <td style='color: #7795c1;text-align:left;'><%=t :full_text%></td>
          <td>
            <%= raw @article.content%>
          </td>
        </tr>

        <tr>
          <td style='color: #7795c1;text-align:left;'><%=t :attachments%></td>


          <td>
            <% Upload.where(uploadable_type: 'Article', uploadable_id: @article.id).group_by(&:attachment_type).each do |k,v| %>
            <%=t k%>
            <ul>
              <% for u in v%>
              <li><%= link_to u.attachment.url do%><i class="fe fe-download" style="vertical-align:middle;"></i> <%= u.title%><%end%>
                <p class="text-muted">
                    <%= u.detail%>
                </p>
              </li>
              <%end%>
            </ul>
            <%end%>
          </td>
        </tr>

      </tbody>
    </table>
