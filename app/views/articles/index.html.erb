<div class="row row-cards row-deck">
  <div class="col-lg-3">
    <div class="row">
      <div class="col-md-6 col-lg-12">
        <div class="card">
          <div class="card-body">
            <div class="text-center">
              <%= link_to  new_article_url, class: "btn btn-lime  btn-sm" do%>
                <i class="fe fe-plus" style="vertical-align:-3px;"></i> <%=t :new%>
              <%end%>
            </div>
          </div>
          <div class="card-footer">
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-9">
    <div class="card">
      <div class="table-responsive">
        <table class="table table-hover table-outline table-vcenter text-nowrap card-table">
          <thead>
            <tr>
              <th class="text-center"><i class="fe fe-command" style="vertical-align: -4px;"></i></th>
              <th><%=t :title%></th>
              <th><%=t :progress%></th>
              <th><%=t :workflow_state %></th>
            </tr>
          </thead>
          <tbody>
            <% for article in @articles%>
            <tr>
              <td class="text-center">
                <div class="item-action dropdown">
                  <a href="javascript:void(0)" data-toggle="dropdown" class="icon"><i class="fe fe-more-vertical"></i></a>
                  <div class="dropdown-menu dropdown-menu-right">
                    <a href="/articles/<%= article.id%>" class="dropdown-item"><i class="dropdown-icon fe fe-play"></i><%=t :show%> </a>
                    <a href="/articles/<%= article.id%>/edit" class="dropdown-item"><i class="dropdown-icon fe fe-edit-2"></i> <%=t :edit%> </a>
                    <%= link_to article, method: :delete, class: "dropdown-item" ,data: { confirm: 'Are you sure?' } do %>
                    <i class="dropdown-icon fe fe-trash"></i> <%=t :destroy%>
                    <%end%>
                    <div class="dropdown-divider"></div>
                    <a href="javascript:void(0)" class="dropdown-item"><i class="dropdown-icon fe fe-link"></i> <%=t :copy_aoi%></a>
                  </div>
                </div>
              </td>
              <td>
                <div><%= truncate(article.title, length: 40)%></div>
                <div class="small text-muted">
                  <%= truncate(article.abstract, length: 30)%>
                </div>
              </td>
              <td>
                <div class="clearfix">
                  <div class="float-left">
                    <strong id="progress_percent_<%= article.id%>">0%</strong>
                  </div>
                  <div class="float-right">
                    <small class="text-muted">
                      <span>
                        <% @jalali = JalaliDate.to_jalali(article.updated_at)%>
                        <%= @jalali.year%>/<%= @jalali.month%>/<%= @jalali.day%>
                      </span>
                    </small>
                  </div>
                </div>
                <div class="progress progress-xs">
                  <% if article.workflow_state%>
                    <% @workflow_states = WorkflowState.where(workflow_id: article.workflow_state.workflow.id).count%>
                    <div id="pb_<%= article.id%>" class="article-progress progress-bar bg-yellow" role="progressbar" style="width: 42%" aria-valuenow="42" aria-valuemin="0" aria-valuemax="100"></div>
                    <p id='nodes_<%= article.id%>' style="display:none"><%= raw article.workflow_state.workflow.nodes%></p>
                    <p id='edges_<%= article.id%>' style="display:none"><%= raw article.workflow_state.workflow.edges%></p>
                    <p id='current_node_<%= article.id%>'><%= article.workflow_state.node_id%></p>
                    <p id='start_node_<%= article.id%>'><%= article.workflow_state.workflow.start_node_id%></p>
                  <%else%>
                    <div class="progress-bar bg-red" role="progressbar" style="width: 2%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                  <%end%>
                </div>
              </td>
              <td>
                <% if article.workflow_state%>
                <div class="small text-muted"><%= article.workflow_state.workflow.title%></div>
                <div style="font-size:smaller;"><%= article.workflow_state.title%></div>
                <%else%>
                <div class="small text-muted"><i class="fe fe-alert-triangle" style="vertical-align:-3px;"></i> <%=t :without_workflow%></div>
                <%end%>
              </td>
            </tr>
            <%end%>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
